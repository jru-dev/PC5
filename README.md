# Sistema de Biblioteca Virtual

Un sistema web desarrollado en Laravel con Oracle Database que permite gestionar el catÃ¡logo de libros de una biblioteca

## ğŸ“‹ CaracterÃ­sticas

- **AutenticaciÃ³n personalizada** con Oracle Database
- **GestiÃ³n completa de libros** (CRUD)
- **Control de roles** (Bibliotecario/Usuario)
- **Dashboard con estadÃ­sticas** en tiempo real
- **Interfaz responsive** con Bootstrap

## ğŸš€ TecnologÃ­as Utilizadas

- **Backend:** Laravel 12.19.3
- **Base de Datos:** Oracle Database
- **Frontend:** Bootstrap 5.1.3
- **PHP:** 8.2+
- **Servidor Web:** Apache/Nginx

## ğŸ“‹ Requisitos Previos

### Software Requerido

1. **PHP 8.2 o superior**
2. **Composer**
3. **Oracle Database** (11g o superior)
4. **Servidor Web** (Apache/Nginx)
5. **Git**

### Extensiones PHP Requeridas

- php-oci8
- php-mbstring
- php-xml
- php-curl
- php-zip

## ğŸ› ï¸ InstalaciÃ³n

### 1. Clonar el Repositorio

```bash
git clone https://github.com/tu-usuario/biblioteca-virtual.git
cd biblioteca-virtual
```

### 2. Instalar Dependencias

```bash
composer install
```

### 3. Configurar el Archivo de Entorno

```bash
cp .env.example .env
```

Editar el archivo `.env` con tu configuraciÃ³n:

```env
APP_NAME="Biblioteca Virtual"
APP_ENV=local
APP_DEBUG=true
APP_URL=http://localhost:8000

# ConfiguraciÃ³n Oracle
DB_CONNECTION=oracle
DB_HOST=localhost
DB_PORT=1521
DB_DATABASE=XE
DB_USERNAME=tu_usuario_oracle
DB_PASSWORD=tu_password_oracle
DB_CHARSET=AL32UTF8

# ConfiguraciÃ³n de Sesiones
SESSION_DRIVER=file
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
```

### 4. Generar Clave de AplicaciÃ³n

```bash
php artisan key:generate
```

### 5. Configurar Oracle

#### Instalar Oracle Instant Client

**Windows:**
1. Descargar Oracle Instant Client desde el sitio oficial
2. Extraer en `C:\instantclient_XX_X`
3. Agregar la ruta al PATH del sistema

**Linux/Ubuntu:**
```bash
sudo apt-get install alien libaio1
# Descargar e instalar Oracle Instant Client
```

#### Instalar ExtensiÃ³n OCI8

**Con PECL:**
```bash
sudo pecl install oci8
```

**Activar en php.ini:**
```ini
extension=oci8
```

### 6. Configurar Base de Datos

#### Crear las Tablas

```sql
-- Tabla de usuarios
CREATE TABLE usuarios (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) UNIQUE NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    password VARCHAR2(255) NOT NULL,
    rol VARCHAR2(20) DEFAULT 'usuario' CHECK (rol IN ('bibliotecario', 'usuario')),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabla de libros
CREATE TABLE libros (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    titulo VARCHAR2(200) NOT NULL,
    autor VARCHAR2(100) NOT NULL,
    isbn VARCHAR2(20) UNIQUE,
    categoria VARCHAR2(50),
    disponible NUMBER(1) DEFAULT 1 CHECK (disponible IN (0,1)),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### Crear Procedimientos Almacenados

```sql
-- Procedimiento para login
CREATE OR REPLACE PROCEDURE sp_login_usuario(
    p_username IN VARCHAR2,
    p_password IN VARCHAR2,
    p_resultado OUT VARCHAR2,
    p_rol OUT VARCHAR2
) 
AS
BEGIN
    SELECT rol INTO p_rol 
    FROM usuarios 
    WHERE username = p_username AND password = p_password;
    
    p_resultado := 'SUCCESS';
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_resultado := 'INVALID_CREDENTIALS';
        p_rol := NULL;
    WHEN OTHERS THEN
        p_resultado := 'ERROR';
        p_rol := NULL;
END sp_login_usuario;
/

-- Procedimiento para listar libros
CREATE OR REPLACE PROCEDURE sp_listar_libros(
    p_cursor OUT SYS_REFCURSOR
) 
AS
BEGIN
    OPEN p_cursor FOR
        SELECT id, titulo, autor, isbn, categoria, disponible
        FROM libros
        ORDER BY titulo;
END sp_listar_libros;
/

-- Procedimiento para insertar libro
CREATE OR REPLACE PROCEDURE sp_insertar_libro(
    p_titulo IN VARCHAR2,
    p_autor IN VARCHAR2,
    p_isbn IN VARCHAR2,
    p_categoria IN VARCHAR2,
    p_resultado OUT VARCHAR2
) 
AS
BEGIN
    INSERT INTO libros (titulo, autor, isbn, categoria, disponible)
    VALUES (p_titulo, p_autor, p_isbn, p_categoria, 1);
    
    p_resultado := 'SUCCESS';
    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
        p_resultado := 'ERROR';
        ROLLBACK;
END sp_insertar_libro;
/
```

#### Insertar Datos de Prueba

```sql
-- Usuarios de prueba
INSERT INTO usuarios (username, email, password, rol) 
VALUES ('admin', 'admin@biblioteca.com', 'admin123', 'bibliotecario');

INSERT INTO usuarios (username, email, password, rol) 
VALUES ('usuario1', 'usuario1@ejemplo.com', '123456', 'usuario');

-- Libros de prueba
INSERT INTO libros (titulo, autor, isbn, categoria, disponible) 
VALUES ('Cien aÃ±os de soledad', 'Gabriel GarcÃ­a MÃ¡rquez', '978-0307474728', 'Literatura', 1);

INSERT INTO libros (titulo, autor, isbn, categoria, disponible) 
VALUES ('Don Quijote de la Mancha', 'Miguel de Cervantes', '978-8437604947', 'ClÃ¡sicos', 1);

INSERT INTO libros (titulo, autor, isbn, categoria, disponible) 
VALUES ('1984', 'George Orwell', '978-0451524935', 'FicciÃ³n', 0);

COMMIT;
```

### 7. Verificar ConexiÃ³n

```bash
# Probar la conexiÃ³n a Oracle
php artisan tinker
DB::connection('oracle')->select('SELECT 1 as test FROM dual');
```

### 8. Iniciar el Servidor

```bash
php artisan serve
```

Visita: `http://localhost:8000`

## ğŸ‘¥ Usuarios de Prueba

| Usuario | ContraseÃ±a | Rol |
|---------|------------|-----|
| admin | admin123 | bibliotecario |
| usuario1 | 123456 | usuario |

## ğŸ“ Estructura del Proyecto

```
biblioteca-virtual/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ Http/
â”‚   â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthController.php
â”‚   â”‚   â”‚   â””â”€â”€ LibroController.php
â”‚   â”‚   â””â”€â”€ Middleware/
â”‚   â”‚       â””â”€â”€ OracleAuth.php
â”œâ”€â”€ resources/
â”‚   â””â”€â”€ views/
â”‚       â”œâ”€â”€ auth/
â”‚       â”‚   â””â”€â”€ login.blade.php
â”‚       â”œâ”€â”€ libros/
â”‚       â”‚   â”œâ”€â”€ index.blade.php
â”‚       â”‚   â”œâ”€â”€ create.blade.php
â”‚       â”‚   â”œâ”€â”€ show.blade.php
â”‚       â”‚   â””â”€â”€ edit.blade.php
â”‚       â””â”€â”€ dashboard.blade.php
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ web.php
â””â”€â”€ bootstrap/
    â””â”€â”€ app.php
```

## ğŸ”§ Funcionalidades

### Para Usuarios
- âœ… Iniciar sesiÃ³n
- âœ… Ver catÃ¡logo de libros
- âœ… Ver detalles de libros
- âœ… Consultar estadÃ­sticas

### Para Bibliotecarios
- âœ… Todas las funciones de usuario
- âœ… Agregar nuevos libros
- âœ… Editar informaciÃ³n de libros
- âœ… Eliminar libros
- âœ… Cambiar estado de disponibilidad

## ğŸ› SoluciÃ³n de Problemas

### Error: "Vite manifest not found"
```bash
# Instalar dependencias y compilar assets
npm install
npm run build
```

### Error: "Unsupported driver [oracle]"
```bash
# Verificar que se instalÃ³ correctamente yajra/laravel-oci8
composer show yajra/laravel-oci8

# Limpiar cachÃ©
php artisan config:clear
php artisan cache:clear
```

### Error de conexiÃ³n Oracle
1. Verificar que Oracle estÃ© ejecutÃ¡ndose
2. Comprobar credenciales en `.env`
3. Verificar que la extensiÃ³n OCI8 estÃ© instalada: `php -m | grep oci`

## ğŸ“„ Base de Datos - Opciones de DistribuciÃ³n

### OpciÃ³n 1: Archivo SQL (Recomendado)
Crear un archivo `database/schema.sql` con todas las tablas, procedimientos y datos:

```sql
-- Ver archivo schema.sql incluido en el proyecto
```

### OpciÃ³n 2: Export/Import Oracle
```bash
# Exportar (en el servidor origen)
expdp username/password@database directory=DATA_PUMP_DIR dumpfile=biblioteca.dmp schemas=tu_esquema

# Importar (en el servidor destino)
impdp username/password@database directory=DATA_PUMP_DIR dumpfile=biblioteca.dmp schemas=tu_esquema
```

### OpciÃ³n 3: Backup Completo
```sql
-- Crear backup completo
CREATE OR REPLACE DIRECTORY backup_dir AS '/path/to/backup';
-- Usar Oracle RMAN para backup/restore completo
```

## ğŸ¤ Contribuir

1. Fork el proyecto
2. Crear una rama feature (`git checkout -b feature/nueva-funcionalidad`)
3. Commit los cambios (`git commit -m 'Agregar nueva funcionalidad'`)
4. Push a la rama (`git push origin feature/nueva-funcionalidad`)
5. Abrir un Pull Request

## ğŸ“ Licencia

Este proyecto estÃ¡ bajo la Licencia MIT - ver el archivo [LICENSE.md](LICENSE.md) para mÃ¡s detalles.

## ğŸ“ Soporte

Si tienes problemas con la instalaciÃ³n:

1. Revisa la secciÃ³n de soluciÃ³n de problemas
2. Verifica que todos los requisitos estÃ©n instalados
3. Comprueba los logs de Laravel: `storage/logs/laravel.log`
4. Verifica la conexiÃ³n Oracle con el comando de prueba

## ğŸš€ Siguientes Pasos

- [ ] Implementar mÃ³dulo de prÃ©stamos
- [ ] Agregar sistema de reportes
- [ ] Implementar bÃºsqueda avanzada
- [ ] Agregar API REST
- [ ] Implementar notificaciones